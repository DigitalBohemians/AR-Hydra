<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>AR Location ‚Äì Hydra Kunst</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.5/aframe/build/aframe-ar.js"></script>

    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { background: #000; overflow: hidden; font-family: sans-serif; }

      #overlay {
        position: fixed; inset: 0; background: rgba(0,0,0,0.85);
        display: flex; flex-direction: column; align-items: center;
        justify-content: center; z-index: 9999; color: white;
        text-align: center; padding: 30px;
      }

      #overlay h1 { font-size: 28px; margin-bottom: 12px; }
      #overlay p  { font-size: 15px; margin-bottom: 24px; opacity: 0.8; }

      #startBtn {
        padding: 16px 36px; font-size: 18px; font-weight: 700;
        background: #fff; color: #000; border: none;
        border-radius: 14px; cursor: pointer;
      }

      #status {
        position: fixed; top: 16px; left: 50%; transform: translateX(-50%);
        background: rgba(0,0,0,0.6); color: white; padding: 8px 16px;
        border-radius: 20px; font-size: 13px; z-index: 8888;
        display: none; white-space: nowrap;
      }
    </style>
  </head>

  <body>

    <div id="overlay">
      <h1>üó∫ AR auf Hydra</h1>
      <p>Kamera &amp; Standort erlauben.<br/>
         <small>üìç N37¬∞ 21.020' E023¬∞ 28.016'</small>
      </p>
      <button id="startBtn">‚ñ∂ AR Starten</button>
    </div>

    <div id="status">üìç GPS wird ermittelt‚Ä¶</div>

    <a-scene
      vr-mode-ui="enabled: false"
      renderer="antialias: true; alpha: true;"
      arjs="sourceType: webcam; debugUIEnabled: false; trackingMethod: best;"
      loading-screen="enabled: false"
    >

      <a-assets>
        <img id="bild" src="8FE8AA28-375B-4C00-B168-BCDECCBDCEA6.png" crossorigin="anonymous" />
      </a-assets>

      <!-- Marker Zylinder am Trigger-Punkt -->
      <a-cylinder
        gps-entity-place="latitude: 37.35033; longitude: 23.46693"
        radius="0.3"
        height="0.15"
        color="#00ffcc"
      ></a-cylinder>

      <!-- Kunst-Anzeige an der Anzeigekoordinate, 180¬∞ gedreht -->
      <a-entity
        gps-entity-place="latitude: 37.35030; longitude: 23.46696"
        rotation="0 180 0"
      >

        <!-- Bild -->
        <a-plane
          src="#bild"
          width="3"
          height="2"
          position="0 2 0"
        ></a-plane>

        <!-- Text -->
        <a-text
          value="Die Kunst im Code\nN37¬∞ 21.018' E023¬∞ 28.018'"
          color="white"
          align="center"
          width="6"
          position="0 0.5 0"
        ></a-text>

      </a-entity>

      <!-- minDistance: 2 = Objekte werden erst neu positioniert wenn man 2m bewegt hat -->
      <a-camera gps-camera="minDistance: 2" rotation-reader></a-camera>

    </a-scene>

    <script>
      document.getElementById('startBtn').addEventListener('click', () => {
        document.getElementById('overlay').style.display = 'none';
        document.getElementById('status').style.display  = 'block';

        navigator.geolocation.watchPosition(
          (pos) => {
            const lat = pos.coords.latitude.toFixed(5);
            const lon = pos.coords.longitude.toFixed(5);
            const acc = Math.round(pos.coords.accuracy);
            document.getElementById('status').textContent =
              `üìç ${lat}, ${lon} (¬±${acc}m)`;
          },
          (err) => {
            document.getElementById('status').textContent =
              '‚ö†Ô∏è GPS Fehler: ' + err.message;
          },
          {
            enableHighAccuracy: true,
            maximumAge: 5000,        // GPS-Position max. 5 Sekunden cachen
            timeout: 10000           // nach 10s Fehler wenn kein Signal
          }
        );
      });
    </script>

  </body>
</html>
